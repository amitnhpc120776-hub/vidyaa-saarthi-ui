<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Vidyaa Saarthi – Symbol Matching (Practice)</title>

    <!-- Bootstrap 5 -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- VIS Design System -->
    <link rel="stylesheet" href="../../../css/VS-Design-System.css" />
    <link rel="stylesheet" href="../../../css/custom-component.css" />

    <style>
      .sm-test-shell {
        max-width: 520px;
        margin-inline: auto;
      }

      .sm-frame {
        background: var(--bs-body-bg);
        border: 1px solid var(--bs-border-color);
        border-radius: var(--bs-border-radius-lg);
        padding: 20px;
      }

      .sm-header {
        text-align: center;
        padding: 16px 0 8px;
      }

      .sm-header img {
        height: 44px;
        margin-bottom: 6px;
      }

      .sm-title {
        font-weight: 600;
      }

      .sm-practice-counter,
      .sm-trial-timer {
        font-size: 0.85rem;
        color: var(--bs-secondary-color);
        margin-top: 4px;
      }

      .sm-symbols-wrapper {
        margin-top: 36px;
        text-align: center;
      }

      .sm-symbols-row {
        display: flex;
        justify-content: center;
        gap: 32px;
        font-size: 2.4rem;
        font-weight: 700;
      }

      .sm-symbol-box {
        width: 72px;
        height: 72px;
        display: grid;
        place-items: center;
        border-radius: var(--bs-border-radius);
        border: 2px solid var(--bs-primary);
        background: var(--primary-50);
      }

      .sm-response-wrapper {
        margin-top: 36px;
      }

      .sm-response-buttons {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 16px;
      }

      .sm-response-btn {
        min-height: 52px;
        font-size: 1rem;
        font-weight: 600;
        border-width: 2px;
      }

      .sm-response-btn.correct {
        border-color: var(--bs-success);
        box-shadow: 0 0 0 0.25rem rgba(25, 135, 84, 0.25);
      }

      .sm-response-btn.wrong {
        border-color: var(--bs-danger);
        box-shadow: 0 0 0 0.25rem rgba(220, 53, 69, 0.25);
      }

      .sm-start-cta.hidden,
      .sm-task-area.hidden {
        display: none;
      }

      .sm-complete-screen {
        margin-top: 64px;
        max-width: 420px;
      }

      .sm-illustration-panel {
        background-color: var(--primary-900);
        min-height: 100vh;
      }
    </style>
  </head>

  <body class="bg-light">
    <div class="container-fluid">
      <div class="row min-vh-100">
        <!-- LEFT -->
        <div class="col-12 col-md-5 d-flex flex-column align-items-center">
          <div class="w-100 sm-test-shell">
            <div class="sm-header">
              <img src="../../../assets/logo/vsLogoWithouText.svg" />
              <div class="sm-title">Symbol Matching – Practice</div>

              <div class="sm-start-cta">
                <button id="startBtn" class="btn btn-primary px-4 py-2">
                  Click to begin practice
                </button>
              </div>

              <div class="sm-practice-counter">
                Questions Remaining:
                <strong><span id="remaining">6</span> / 6</strong>
              </div>

              <div class="sm-trial-timer">
                Time Remaining: <strong><span id="trialTimer">3</span>s</strong>
              </div>
            </div>

            <div id="taskArea" class="sm-task-area hidden">
              <div class="sm-symbols-wrapper">
                <div class="sm-frame">
                  <div class="sm-symbols-row">
                    <div class="sm-symbol-box" id="leftSymbol"></div>
                    <div class="sm-symbol-box" id="rightSymbol"></div>
                  </div>
                </div>
              </div>

              <div class="sm-response-wrapper">
                <div class="sm-frame">
                  <div class="sm-response-buttons">
                    <button
                      class="btn btn-outline-primary sm-response-btn"
                      data-answer="same"
                    >
                      Same
                    </button>
                    <button
                      class="btn btn-outline-primary sm-response-btn"
                      data-answer="different"
                    >
                      Different
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <div
              id="completeScreen"
              class="sm-complete-screen d-none text-center"
            >
              <h5 class="fw-semibold mb-2">Practice Complete</h5>
              <p class="text-muted small mb-4">
                You have finished the practice round.
              </p>

              <div class="d-grid gap-2">
                <button id="restartPracticeBtn" class="btn btn-outline-primary">
                  Start Practice Again
                </button>

                <button id="backToInstructionsBtn" class="btn btn-primary">
                  Back to Instructions
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- RIGHT -->
        <div class="col-md-7 d-none d-md-flex p-0 sm-illustration-panel">
          <img
            src="../../../assets/illustration/signupAndLogin/signupAndLogin.svg"
            class="img-fluid w-100 h-100 object-fit-cover"
          />
        </div>
      </div>
    </div>

    <script>
      const SYMBOLS = ["○", "△", "□", "★", "＋", "×"];
      const TOTAL_TRIALS = 6;
      const TRIAL_TIME = 3;

      let trials = [];
      let currentIndex = 0;
      let timer = null;
      let timeLeft = TRIAL_TIME;

      const leftEl = document.getElementById("leftSymbol");
      const rightEl = document.getElementById("rightSymbol");
      const timerEl = document.getElementById("trialTimer");
      const remainingEl = document.getElementById("remaining");
      const buttons = document.querySelectorAll(".sm-response-btn");

      function shuffle(arr) {
        return arr.sort(() => Math.random() - 0.5);
      }

      function generateTrials() {
        const same = Array.from({ length: 3 }, () => ({ type: "same" }));
        const diff = Array.from({ length: 3 }, () => ({ type: "different" }));
        return shuffle([...same, ...diff]);
      }

      function loadTrial() {
        if (currentIndex >= TOTAL_TRIALS) {
          endPractice();
          return;
        }

        buttons.forEach((b) => b.classList.remove("correct", "wrong"));

        const trial = trials[currentIndex];
        const symbolA = SYMBOLS[Math.floor(Math.random() * SYMBOLS.length)];
        const symbolB =
          trial.type === "same"
            ? symbolA
            : SYMBOLS.filter((s) => s !== symbolA)[
                Math.floor(Math.random() * (SYMBOLS.length - 1))
              ];

        leftEl.textContent = symbolA;
        rightEl.textContent = symbolB;

        timeLeft = TRIAL_TIME;
        timerEl.textContent = timeLeft;
        remainingEl.textContent = TOTAL_TRIALS - currentIndex;

        timer = setInterval(() => {
          timeLeft--;
          timerEl.textContent = timeLeft;
          if (timeLeft === 0) nextTrial();
        }, 1000);
      }

      function handleAnswer(answer, btn) {
        clearInterval(timer);
        const correct =
          (answer === "same" && leftEl.textContent === rightEl.textContent) ||
          (answer === "different" &&
            leftEl.textContent !== rightEl.textContent);

        btn.classList.add(correct ? "correct" : "wrong");

        setTimeout(nextTrial, 700);
      }

      function nextTrial() {
        clearInterval(timer);
        currentIndex++;
        loadTrial();
      }

      function endPractice() {
        document.getElementById("taskArea").classList.add("hidden");
        document.getElementById("completeScreen").classList.remove("d-none");
      }

      document.getElementById("startBtn").onclick = () => {
        document.querySelector(".sm-start-cta").classList.add("hidden");
        document.getElementById("taskArea").classList.remove("hidden");
        trials = generateTrials();
        loadTrial();
      };

      buttons.forEach((btn) =>
        btn.addEventListener("click", () =>
          handleAnswer(btn.dataset.answer, btn)
        )
      );
      // Restart Practice: full reset
      document
        .getElementById("restartPracticeBtn")
        .addEventListener("click", () => {
          // simplest & safest reset for practice
          window.location.reload();
        });
      // Back to Instructions: absolute correct path
      document
        .getElementById("backToInstructionsBtn")
        .addEventListener("click", () => {
          window.location.href = "symbolMatchingInnstruction.html";
        });
    </script>
  </body>
</html>
